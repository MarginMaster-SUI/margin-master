# MarginMaster - æœ€çµ‚å®Œæ•´è¨­è¨ˆæ–‡æª”

> **ç‰ˆæœ¬:** 2.0 (å„ªåŒ–ç‰ˆ)
> **æ—¥æœŸ:** 2026-02-02
> **ç‹€æ…‹:** Ready for Implementation
> **é è¨ˆé–‹ç™¼æ™‚é–“:** 7 å¤© (Hackathon) + å¾ŒçºŒè¿­ä»£

---

## ğŸ“‹ ç›®éŒ„

1. [åŸ·è¡Œæ‘˜è¦](#åŸ·è¡Œæ‘˜è¦)
2. [ç”¢å“æ¦‚è¿°](#ç”¢å“æ¦‚è¿°)
3. [å¸‚å ´åˆ†æ](#å¸‚å ´åˆ†æ)
4. [ç³»çµ±æ¶æ§‹](#ç³»çµ±æ¶æ§‹)
5. [æŠ€è¡“æ£§](#æŠ€è¡“æ£§)
6. [æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„](#æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„)
7. [æ™ºèƒ½åˆç´„è¨­è¨ˆ](#æ™ºèƒ½åˆç´„è¨­è¨ˆ)
8. [å‰ç«¯æ¶æ§‹](#å‰ç«¯æ¶æ§‹)
9. [å¾Œç«¯æ¶æ§‹](#å¾Œç«¯æ¶æ§‹)
10. [æ•¸æ“šåº«è¨­è¨ˆ](#æ•¸æ“šåº«è¨­è¨ˆ)
11. [API è¨­è¨ˆ](#api-è¨­è¨ˆ)
12. [é¢¨éšªç®¡ç†ç³»çµ±](#é¢¨éšªç®¡ç†ç³»çµ±)
13. [å®‰å…¨æ€§è¨­è¨ˆ](#å®‰å…¨æ€§è¨­è¨ˆ)
14. [æ€§èƒ½å„ªåŒ–](#æ€§èƒ½å„ªåŒ–)
15. [é–‹ç™¼è¨ˆåŠƒ](#é–‹ç™¼è¨ˆåŠƒ)
16. [æ¸¬è©¦ç­–ç•¥](#æ¸¬è©¦ç­–ç•¥)
17. [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
18. [æœªä¾†æ“´å±•è·¯ç·šåœ–](#æœªä¾†æ“´å±•è·¯ç·šåœ–)
19. [é™„éŒ„](#é™„éŒ„)

---

## åŸ·è¡Œæ‘˜è¦

### é …ç›®å®šä½

**MarginMaster** æ˜¯åŸºæ–¼ Sui å€å¡Šéˆå’Œ DeepBook Margin å”è­°çš„**ç¤¾äº¤åŒ–ä¿è­‰é‡‘äº¤æ˜“å¹³å°**ï¼Œçµåˆè¤‡è£½äº¤æ˜“ã€AI é¢¨éšªç®¡ç†å’Œäº¤æ˜“è€…æ’è¡Œæ¦œåŠŸèƒ½ï¼Œæ—¨åœ¨é™ä½ DeFi ä¿è­‰é‡‘äº¤æ˜“é–€æª»ä¸¦æä¾›é€æ˜çš„ç¤¾äº¤äº¤æ˜“é«”é©—ã€‚

### æ ¸å¿ƒåƒ¹å€¼ä¸»å¼µ

| ç¶­åº¦ | åƒ¹å€¼ |
|------|------|
| **æ™‚æ©Ÿå„ªå‹¢** | DeepBook Margin æ–¼ 2025/1 æ¨å‡ºï¼Œå¸‚å ´ç©ºç¼ºæ˜é¡¯ |
| **æŠ€è¡“å„ªå‹¢** | Sui ä½ gas + å¿«é€Ÿç¢ºèªï¼Œå®Œç¾é©é…é«˜é »è·Ÿå–® |
| **å•†æ¥­æ¨¡å¼** | é›™é‡æ”¶å…¥ï¼šDeepBook æ¨è–¦çå‹µ + è·Ÿå–®è²»ç”¨åˆ†æˆ |
| **ç«¶çˆ­å„ªå‹¢** | Sui ç”Ÿæ…‹é¦–å€‹ç¤¾äº¤åŒ–ä¿è­‰é‡‘äº¤æ˜“å¹³å° |
| **å¯è¡Œæ€§** | åŸºæ–¼æˆç†Ÿ SDKï¼Œ7 å¤©å¯å®Œæˆ MVP |

### é—œéµæŒ‡æ¨™ç›®æ¨™

**Hackathon éšæ®µ (7 å¤©)**
- âœ… å®Œæ•´çš„ä¿è­‰é‡‘äº¤æ˜“ç•Œé¢
- âœ… å¯é‹ä½œçš„ä¸€éµè·Ÿå–®ç³»çµ±
- âœ… Top 10 äº¤æ˜“è€…æ’è¡Œæ¦œ
- âœ… å¯¦æ™‚é¢¨éšªè­¦å ±ç³»çµ±
- âœ… å®Œæ•´çš„ Demo å½±ç‰‡

**Post-Hackathon (1 å€‹æœˆ)**
- ğŸ¯ 100+ æ´»èºç”¨æˆ¶
- ğŸ¯ 10+ èªè­‰äº¤æ˜“è€…
- ğŸ¯ $100K+ ç´¯è¨ˆäº¤æ˜“é‡
- ğŸ¯ 50+ æ´»èºè·Ÿå–®é—œä¿‚

**é•·æœŸç›®æ¨™ (6 å€‹æœˆ)**
- ğŸ¯ 1000+ æ´»èºç”¨æˆ¶
- ğŸ¯ $10M+ æœˆäº¤æ˜“é‡
- ğŸ¯ ç­–ç•¥å¸‚å ´ä¸Šç·š
- ğŸ¯ ç§»å‹• App ç™¼å¸ƒ

---

## ç”¢å“æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½

#### 1. ä¿è­‰é‡‘äº¤æ˜“é¢æ¿
- å¸‚åƒ¹å–® / é™åƒ¹å–®æ”¯æŒ
- 1x - 10x æ§“æ¡¿é¸æ“‡
- å¯¦æ™‚é¢¨éšªæŒ‡æ¨™é¡¯ç¤º
- é ä¼°æ¸…ç®—åƒ¹æ ¼è¨ˆç®—
- ä¸€éµæ­¢æ/æ­¢ç›ˆè¨­ç½®

#### 2. ç¤¾äº¤è·Ÿå–®ç³»çµ±
- **ä¸€éµè·Ÿå–®** - è‡ªå‹•è¤‡è£½äº¤æ˜“è€…çš„æ‰€æœ‰æ“ä½œ
- **è‡ªå®šç¾©è·Ÿå–®æ¯”ä¾‹** - 1%-100% éˆæ´»èª¿æ•´
- **æ™ºèƒ½é¢¨éšªæ§åˆ¶** - è‡ªå‹•æª¢æŸ¥è·Ÿå–®å‰é¢¨éšªæ¯”ç‡
- **å¯¦æ™‚ç‹€æ…‹åŒæ­¥** - è·Ÿå–®åŸ·è¡ŒæˆåŠŸ/å¤±æ•—é€šçŸ¥
- **è²»ç”¨é€æ˜** - æ˜ç¢ºçš„è·Ÿå–®è²»ç‡é¡¯ç¤º

#### 3. äº¤æ˜“è€…æ’è¡Œæ¦œ
- **å¤šç¶­åº¦æ’å**
  - 30 å¤©ç›ˆè™§ (PnL)
  - å‹ç‡ (Win Rate)
  - å¤æ™®æ¯”ç‡ (Sharpe Ratio)
  - æœ€å¤§å›æ’¤ (Max Drawdown)
  - è·Ÿéš¨è€…æ•¸é‡
- **è©³ç´°æª”æ¡ˆé **
  - æ­·å²ç¸¾æ•ˆåœ–è¡¨
  - æœ€è¿‘äº¤æ˜“è¨˜éŒ„
  - è·Ÿéš¨è€…åˆ—è¡¨
  - äº¤æ˜“é¢¨æ ¼æ¨™ç±¤

#### 4. AI é¢¨éšªç®¡ç†
- **å¯¦æ™‚é¢¨éšªè©•åˆ†** - 0-100 åˆ†å¥åº·åº¦è©•åˆ†
- **æ™ºèƒ½è­¦å ±ç³»çµ±**
  - æ¥è¿‘æ¸…ç®—æé†’
  - ä¿è­‰é‡‘ä½¿ç”¨ç‡éé«˜è­¦å‘Š
  - å¸‚å ´æ³¢å‹•ç‡é è­¦
- **è‡ªå‹•åŒ–å»ºè­°**
  - å»ºè­°æ­¢æåƒ¹ä½
  - å»ºè­°æ¸›å€‰æ¯”ä¾‹
  - é¢¨éšªå°æ²–ç­–ç•¥

#### 5. æ¨¡æ“¬äº¤æ˜“æ¨¡å¼ï¼ˆæ–°å¢ï¼‰
- æ–°æ‰‹ç„¡é¢¨éšªç·´ç¿’ç’°å¢ƒ
- è™›æ“¬è³‡é‡‘æ¨¡æ“¬çœŸå¯¦äº¤æ˜“
- ç¸¾æ•ˆè¿½è¹¤èˆ‡å­¸ç¿’åˆ†æ

### ç”¨æˆ¶æ—…ç¨‹

#### æ–°æ‰‹ç”¨æˆ¶æµç¨‹
```
è¨»å†Šä¸¦é€£æ¥éŒ¢åŒ…
    â†“
é€²å…¥æ¨¡æ“¬äº¤æ˜“æ¨¡å¼ï¼ˆæ¨è–¦ï¼‰
    â†“
ç€è¦½æ’è¡Œæ¦œï¼Œé¸æ“‡å¿ƒå„€äº¤æ˜“è€…
    â†“
æŸ¥çœ‹äº¤æ˜“è€…è©³ç´°æª”æ¡ˆèˆ‡ç¸¾æ•ˆ
    â†“
è¨­ç½®è·Ÿå–®åƒæ•¸ï¼ˆæ¯”ä¾‹ã€æœ€å¤§å€‰ä½ï¼‰
    â†“
å•Ÿç”¨è·Ÿå–®ä¸¦æ¥æ”¶å¯¦æ™‚é€šçŸ¥
    â†“
ç›£æ§é¢¨éšªå„€è¡¨æ¿
    â†“
ï¼ˆå¯é¸ï¼‰å‡ç´šç‚ºçœŸå¯¦äº¤æ˜“
```

#### äº¤æ˜“è€…æµç¨‹
```
é€£æ¥éŒ¢åŒ…ä¸¦å‰µå»º Margin Manager
    â†“
å®Œæˆäº¤æ˜“è€…èªè­‰ï¼ˆå¯é¸ï¼‰
    â†“
é€²è¡Œä¿è­‰é‡‘äº¤æ˜“
    â†“
ç³»çµ±è‡ªå‹•ç™¼å¸ƒäº¤æ˜“ä¿¡è™Ÿ
    â†“
Followers è‡ªå‹•è·Ÿå–®
    â†“
ç²å¾—è·Ÿå–®è²»ç”¨åˆ†æˆ
    â†“
æå‡æ’åï¼Œå¸å¼•æ›´å¤š Followers
```

---

## å¸‚å ´åˆ†æ

### ç›®æ¨™å¸‚å ´

#### ä¸»è¦ç”¨æˆ¶ç¾¤é«”

1. **DeFi æ–°æ‰‹äº¤æ˜“è€…** (40%)
   - æƒ³åƒèˆ‡ä¿è­‰é‡‘äº¤æ˜“ä½†ç¼ºä¹ç¶“é©—
   - é¡˜æ„ä»˜è²»è·Ÿéš¨æˆåŠŸäº¤æ˜“è€…
   - é¢¨éšªæ‰¿å—èƒ½åŠ›ï¼šä½-ä¸­

2. **ç¶“é©—è±å¯Œçš„äº¤æ˜“è€…** (30%)
   - å°‹æ±‚é¡å¤–æ”¶å…¥ä¾†æºï¼ˆè·Ÿå–®è²»ç”¨ï¼‰
   - é¡˜æ„åˆ†äº«ç­–ç•¥ä»¥å»ºç«‹å€‹äººå“ç‰Œ
   - é¢¨éšªæ‰¿å—èƒ½åŠ›ï¼šä¸­-é«˜

3. **é‡åŒ–äº¤æ˜“åœ˜éšŠ** (20%)
   - å°‹æ±‚ç­–ç•¥è®Šç¾æ¸ é“
   - éœ€è¦ä½å»¶é²åŸ·è¡Œç’°å¢ƒ
   - é¢¨éšªæ‰¿å—èƒ½åŠ›ï¼šé«˜

4. **ç­–ç•¥ç ”ç©¶è€…** (10%)
   - æ¸¬è©¦èˆ‡å„ªåŒ–äº¤æ˜“ç­–ç•¥
   - éœ€è¦å›æ¸¬èˆ‡åˆ†æå·¥å…·
   - é¢¨éšªæ‰¿å—èƒ½åŠ›ï¼šä¸­

### ç«¶çˆ­åˆ†æ

#### ç¾æœ‰ç«¶çˆ­è€…

| å¹³å° | é¡å‹ | å„ªå‹¢ | åŠ£å‹¢ |
|------|------|------|------|
| **DeepTrade** | DeepBook å‰ç«¯ | å®˜æ–¹æ¨è–¦ï¼ŒåŠŸèƒ½å®Œæ•´ | ç¼ºä¹ç¤¾äº¤åŠŸèƒ½ |
| **Abyss** | DeFi èšåˆå™¨ | å¤šå”è­°æ”¯æŒ | ä¿è­‰é‡‘äº¤æ˜“ä¸æ˜¯é‡é» |
| **Turbos** | DEX + NFT | ç”¨æˆ¶åŸºç¤å¤§ | æœªå°ˆæ³¨æ–¼ Margin |
| **eToro** (CEX) | ç¤¾äº¤äº¤æ˜“ | æˆç†Ÿçš„è·Ÿå–®ç³»çµ± | ä¸­å¿ƒåŒ–ï¼Œé DeFi |
| **Bybit** (CEX) | è¤‡è£½äº¤æ˜“ | æµå‹•æ€§å¼· | ä¸­å¿ƒåŒ–ï¼Œé«˜è²»ç”¨ |

#### MarginMaster å·®ç•°åŒ–å„ªå‹¢

âœ… **Sui ç”Ÿæ…‹é¦–å€‹** å°ˆæ³¨æ–¼ä¿è­‰é‡‘äº¤æ˜“çš„ç¤¾äº¤å¹³å°
âœ… **å®Œå…¨é€æ˜** éˆä¸Šå¯é©—è­‰çš„äº¤æ˜“è¨˜éŒ„èˆ‡ç¸¾æ•ˆ
âœ… **ä½æˆæœ¬** Sui ä½ gas è²»æ”¯æŒé«˜é »è·Ÿå–®
âœ… **å¿«é€ŸåŸ·è¡Œ** äºç§’ç´šç¢ºèªæ™‚é–“ï¼Œæ¸›å°‘æ»‘é»
âœ… **AI å¢å¼·** æ™ºèƒ½é¢¨éšªç®¡ç†èˆ‡äº¤æ˜“å»ºè­°
âœ… **é›™é‡æ¿€å‹µ** DeepBook ç©åˆ† + è·Ÿå–®è²»ç”¨

### å¸‚å ´è¦æ¨¡ä¼°ç®—

**TAM (Total Addressable Market)**
- å…¨çƒ DeFi ç”¨æˆ¶ï¼š~700 è¬
- ä¿è­‰é‡‘äº¤æ˜“åƒèˆ‡ç‡ï¼š~15%
- **æ½›åœ¨ç”¨æˆ¶ï¼š~100 è¬**

**SAM (Serviceable Addressable Market)**
- Sui ç”Ÿæ…‹ç”¨æˆ¶ï¼š~50 è¬
- DeFi æ´»èºç”¨æˆ¶æ¯”ä¾‹ï¼š~20%
- **å¯è§¸åŠç”¨æˆ¶ï¼š~10 è¬**

**SOM (Serviceable Obtainable Market)**
- Year 1 ç›®æ¨™å¸‚å ´ä»½é¡ï¼š5%
- **é¦–å¹´ç›®æ¨™ç”¨æˆ¶ï¼š~5,000**

---

## ç³»çµ±æ¶æ§‹

### é«˜å±¤æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ¶ç•Œé¢å±¤ (Web App)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚äº¤æ˜“é¢æ¿  â”‚  â”‚æ’è¡Œæ¦œ    â”‚  â”‚è·Ÿå–®ç®¡ç†  â”‚  â”‚é¢¨éšªå„€è¡¨æ¿â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚å€‹äººæª”æ¡ˆ  â”‚  â”‚é€šçŸ¥ä¸­å¿ƒ  â”‚  â”‚æ¨¡æ“¬æ¨¡å¼  â”‚  â”‚ç­–ç•¥å¸‚å ´  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• HTTPS/WSS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ‡‰ç”¨é‚è¼¯å±¤ (React + TypeScript)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ç‹€æ…‹ç®¡ç†  â”‚  â”‚APIå®¢æˆ¶ç«¯ â”‚  â”‚éŒ¢åŒ…é›†æˆ  â”‚  â”‚äº‹ä»¶ç›£è½  â”‚         â”‚
â”‚  â”‚(Zustand) â”‚  â”‚(React    â”‚  â”‚(@mysten/ â”‚  â”‚(WebSocketâ”‚         â”‚
â”‚  â”‚          â”‚  â”‚ Query)   â”‚  â”‚ dapp-kit)â”‚  â”‚)         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚é¢¨éšªè¨ˆç®—  â”‚  â”‚åœ–è¡¨æ¸²æŸ“  â”‚  â”‚æœ¬åœ°å¿«å–  â”‚  â”‚éŒ¯èª¤è™•ç†  â”‚         â”‚
â”‚  â”‚å¼•æ“      â”‚  â”‚(Recharts)â”‚  â”‚(IndexedDBâ”‚  â”‚(Sentry)  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• JSON-RPC / REST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¾Œç«¯æœå‹™å±¤ (Node.js)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚REST API  â”‚  â”‚äº‹ä»¶ç´¢å¼•å™¨â”‚  â”‚æ’è¡Œæ¦œè¨ˆç®—â”‚  â”‚é€šçŸ¥æœå‹™  â”‚         â”‚
â”‚  â”‚(Express) â”‚  â”‚(Sui      â”‚  â”‚(Redis +  â”‚  â”‚(Novu)    â”‚         â”‚
â”‚  â”‚          â”‚  â”‚ Events)  â”‚  â”‚ Cron)    â”‚  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚è·Ÿå–®åŸ·è¡Œå™¨â”‚  â”‚åƒ¹æ ¼ç²å–  â”‚  â”‚é¢¨éšªç›£æ§  â”‚  â”‚Analytics â”‚         â”‚
â”‚  â”‚(Queue    â”‚  â”‚(Pyth/    â”‚  â”‚Keeper    â”‚  â”‚(Mixpanel)â”‚         â”‚
â”‚  â”‚ Worker)  â”‚  â”‚ DeepBook)â”‚  â”‚          â”‚  â”‚          â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• SQL / Redis
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•¸æ“šå­˜å„²å±¤                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  PostgreSQL          â”‚  â”‚  Redis Cache         â”‚              â”‚
â”‚  â”‚  - ç”¨æˆ¶è³‡æ–™          â”‚  â”‚  - æ’è¡Œæ¦œå¿«å–        â”‚              â”‚
â”‚  â”‚  - è·Ÿå–®é—œä¿‚          â”‚  â”‚  - æœƒè©±ç®¡ç†          â”‚              â”‚
â”‚  â”‚  - äº¤æ˜“è¨˜éŒ„          â”‚  â”‚  - å¯¦æ™‚åƒ¹æ ¼          â”‚              â”‚
â”‚  â”‚  - ç¸¾æ•ˆçµ±è¨ˆ          â”‚  â”‚  - ä»»å‹™éšŠåˆ—          â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• Transaction / Query
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ™ºèƒ½åˆç´„å±¤ (Sui Move)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚è·Ÿå–®ç®¡ç†  â”‚  â”‚äº¤æ˜“è€…æª”æ¡ˆâ”‚  â”‚è²»ç”¨åˆ†é…  â”‚  â”‚é¢¨éšªæª¢æŸ¥  â”‚         â”‚
â”‚  â”‚æ¨¡çµ„      â”‚  â”‚æ¨¡çµ„      â”‚  â”‚æ¨¡çµ„      â”‚  â”‚æ¨¡çµ„      â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚è‡ªå‹•è§¸ç™¼å™¨â”‚  â”‚ç”¨æˆ¶è¨»å†Š  â”‚  â”‚ç·Šæ€¥æš«åœ  â”‚  â”‚ç­–ç•¥é‡‘åº«  â”‚         â”‚
â”‚  â”‚æ¨¡çµ„      â”‚  â”‚æ¨¡çµ„      â”‚  â”‚æ¨¡çµ„      â”‚  â”‚(Phase 2) â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†• Move Calls
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DeepBook Margin Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚Margin    â”‚  â”‚Pool Proxyâ”‚  â”‚Order Bookâ”‚  â”‚Liquidationâ”‚        â”‚
â”‚  â”‚Manager   â”‚  â”‚          â”‚  â”‚          â”‚  â”‚Engine     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•¸æ“šç´¢å¼•å±¤ (æ··åˆæ–¹æ¡ˆ)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Surflux Indexer      â”‚  â”‚ è‡ªå»ºäº‹ä»¶ç´¢å¼•å™¨       â”‚              â”‚
â”‚  â”‚ - DeepBookäº¤æ˜“æ•¸æ“š   â”‚  â”‚ - è·Ÿå–®äº‹ä»¶           â”‚              â”‚
â”‚  â”‚ - åƒ¹æ ¼èˆ‡è¡Œæƒ…         â”‚  â”‚ - é¢¨éšªäº‹ä»¶           â”‚              â”‚
â”‚  â”‚ - æµå‹•æ€§æ•¸æ“š         â”‚  â”‚ - ç¸¾æ•ˆæ›´æ–°           â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å¤–éƒ¨æœå‹™å±¤                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚Pyth      â”‚  â”‚Sui Full  â”‚  â”‚IPFS      â”‚  â”‚Email/SMS â”‚         â”‚
â”‚  â”‚Price Feedâ”‚  â”‚Node RPC  â”‚  â”‚(ç­–ç•¥å­˜å„²)â”‚  â”‚Gateway   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•¸æ“šæµæ¶æ§‹

#### 1. äº¤æ˜“ä¸‹å–®æµç¨‹

```mermaid
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant SuiNode
    participant DeepBook

    User->>Frontend: è¼¸å…¥äº¤æ˜“åƒæ•¸
    Frontend->>Frontend: æœ¬åœ°é¢¨éšªæª¢æŸ¥
    Frontend->>Backend: ç²å–ç•¶å‰åƒ¹æ ¼
    Backend->>Pyth/DeepBook: æŸ¥è©¢æœ€æ–°åƒ¹æ ¼
    Pyth/DeepBook-->>Backend: è¿”å›åƒ¹æ ¼
    Backend-->>Frontend: è¿”å›åƒ¹æ ¼æ•¸æ“š
    Frontend->>Frontend: è¨ˆç®—é ä¼°é¢¨éšª
    Frontend->>User: é¡¯ç¤ºç¢ºèªå°è©±æ¡†
    User->>Frontend: ç¢ºèªäº¤æ˜“
    Frontend->>SuiNode: æ§‹å»ºä¸¦ç°½ç½²äº¤æ˜“
    SuiNode->>DeepBook: åŸ·è¡Œä¿è­‰é‡‘ä¸‹å–®
    DeepBook-->>SuiNode: ç™¼å‡ºäº‹ä»¶
    SuiNode-->>Frontend: è¿”å›äº¤æ˜“çµæœ
    Frontend->>Backend: è¨˜éŒ„äº¤æ˜“
    Backend->>Database: å­˜å„²äº¤æ˜“æ•¸æ“š
    Frontend->>User: é¡¯ç¤ºæˆåŠŸ/å¤±æ•—
```

#### 2. è·Ÿå–®åŸ·è¡Œæµç¨‹ï¼ˆå„ªåŒ–ç‰ˆï¼‰

```mermaid
sequenceDiagram
    participant Leader
    participant SuiNode
    participant EventIndexer
    participant CopyTradeWorker
    participant Follower1
    participant Follower2

    Leader->>SuiNode: åŸ·è¡Œäº¤æ˜“
    SuiNode->>SuiNode: ç™¼å‡º LeaderTradeEvent
    SuiNode-->>EventIndexer: æ¨é€äº‹ä»¶
    EventIndexer->>Database: æŸ¥è©¢æ´»èº Followers
    Database-->>EventIndexer: è¿”å› Followers åˆ—è¡¨
    EventIndexer->>CopyTradeWorker: åŠ å…¥åŸ·è¡ŒéšŠåˆ—

    par ä¸¦è¡ŒåŸ·è¡Œè·Ÿå–®
        CopyTradeWorker->>Follower1: æª¢æŸ¥é¢¨éšªæ¯”ç‡
        Follower1-->>CopyTradeWorker: é¢¨éšª OK
        CopyTradeWorker->>SuiNode: åŸ·è¡Œè·Ÿå–®äº¤æ˜“ (F1)
        SuiNode-->>Follower1: ç™¼é€é€šçŸ¥
    and
        CopyTradeWorker->>Follower2: æª¢æŸ¥é¢¨éšªæ¯”ç‡
        Follower2-->>CopyTradeWorker: é¢¨éšªéé«˜
        CopyTradeWorker->>Follower2: è·³éä¸¦é€šçŸ¥
    end

    CopyTradeWorker->>Database: è¨˜éŒ„åŸ·è¡Œçµæœ
    CopyTradeWorker->>NotificationService: ç™¼é€åŸ·è¡Œå ±å‘Š
```

#### 3. é¢¨éšªç›£æ§æµç¨‹

```mermaid
sequenceDiagram
    participant Keeper
    participant SuiNode
    participant RiskEngine
    participant Database
    participant NotificationService
    participant User

    loop æ¯ 30 ç§’
        Keeper->>Database: ç²å–æ‰€æœ‰æ´»èºå€‰ä½
        Database-->>Keeper: è¿”å›å€‰ä½åˆ—è¡¨

        loop æ¯å€‹å€‰ä½
            Keeper->>SuiNode: æŸ¥è©¢ MarginManager ç‹€æ…‹
            SuiNode-->>Keeper: è¿”å›ä¿è­‰é‡‘æ•¸æ“š
            Keeper->>RiskEngine: è¨ˆç®—é¢¨éšªæŒ‡æ¨™
            RiskEngine-->>Keeper: è¿”å›é¢¨éšªè©•åˆ†

            alt å¥åº·åº¦ < 30
                Keeper->>NotificationService: è§¸ç™¼ç·Šæ€¥è­¦å ±
                NotificationService->>User: æ¨é€é€šçŸ¥
                Keeper->>Database: è¨˜éŒ„é¢¨éšªäº‹ä»¶
            else å¥åº·åº¦ < 50
                Keeper->>NotificationService: è§¸ç™¼è­¦å‘Š
                NotificationService->>User: æ¨é€æé†’
            end
        end
    end
```

---

## æŠ€è¡“æ£§

### å‰ç«¯æŠ€è¡“æ£§

```json
{
  "framework": "React 18.2+",
  "language": "TypeScript 5.3+",
  "build_tool": "Vite 5.0+",
  "styling": "Tailwind CSS 3.4+ / CSS Modules",
  "state_management": {
    "global": "Zustand 4.4+",
    "server_state": "TanStack Query (React Query) 5.0+",
    "forms": "React Hook Form 7.48+"
  },
  "wallet_integration": {
    "primary": "@mysten/dapp-kit 0.14+",
    "alternative": "@suiet/wallet-kit 0.2+"
  },
  "blockchain": {
    "sui_sdk": "@mysten/sui.js 0.50+",
    "deepbook": "deepbook-sdk (if available)"
  },
  "charts": {
    "trading_view": "lightweight-charts 4.1+",
    "analytics": "recharts 2.10+"
  },
  "utilities": {
    "date": "date-fns 3.0+",
    "numbers": "bignumber.js 9.1+",
    "notifications": "react-hot-toast 2.4+",
    "forms_validation": "zod 3.22+"
  },
  "testing": {
    "unit": "vitest 1.0+",
    "component": "@testing-library/react 14.0+",
    "e2e": "playwright 1.40+"
  },
  "monitoring": {
    "errors": "@sentry/react 7.90+",
    "analytics": "@mixpanel/browser 2.48+"
  }
}
```

### å¾Œç«¯æŠ€è¡“æ£§

```json
{
  "runtime": "Node.js 20 LTS",
  "language": "TypeScript 5.3+",
  "framework": "Express 4.18+ / Fastify 4.25+",
  "database": {
    "primary": "PostgreSQL 16+",
    "cache": "Redis 7.2+",
    "orm": "Prisma 5.7+ / Drizzle ORM 0.29+"
  },
  "blockchain": {
    "sui_sdk": "@mysten/sui.js 0.50+",
    "event_listener": "custom (WebSocket based)"
  },
  "task_queue": {
    "library": "BullMQ 5.0+",
    "backend": "Redis"
  },
  "price_feeds": {
    "primary": "@pythnetwork/client 2.16+",
    "fallback": "DeepBook mid-price"
  },
  "notification": {
    "engine": "@novu/node 0.22+",
    "channels": ["email", "push", "in-app"]
  },
  "api": {
    "rest": "Express Router",
    "validation": "zod 3.22+",
    "rate_limiting": "express-rate-limit 7.1+"
  },
  "testing": {
    "unit": "vitest 1.0+",
    "integration": "supertest 6.3+",
    "mocking": "@faker-js/faker 8.3+"
  },
  "monitoring": {
    "apm": "@sentry/node 7.90+",
    "logging": "pino 8.17+",
    "metrics": "prom-client 15.1+"
  }
}
```

### æ™ºèƒ½åˆç´„æŠ€è¡“æ£§

```json
{
  "language": "Sui Move",
  "compiler": "Move Compiler 1.16+",
  "testing": "Sui Move Test Framework",
  "deployment": {
    "tool": "sui client CLI",
    "networks": ["devnet", "testnet", "mainnet"]
  },
  "dependencies": {
    "sui_framework": "0x2 (built-in)",
    "deepbook_margin": "DeepBook Margin Package",
    "deepbook_core": "DeepBook Core Package"
  },
  "development": {
    "linter": "move-analyzer",
    "formatter": "move fmt",
    "security": "Sui Move Prover (formal verification)"
  }
}
```

### åŸºç¤è¨­æ–½

```json
{
  "hosting": {
    "frontend": "Vercel / Netlify",
    "backend": "Railway / Render / Fly.io",
    "database": "Supabase / Neon (managed PostgreSQL)"
  },
  "cdn": "Cloudflare CDN",
  "storage": {
    "assets": "Cloudflare R2 / AWS S3",
    "ipfs": "Pinata (for strategies)"
  },
  "monitoring": {
    "uptime": "Better Uptime",
    "logs": "Axiom / Logtail",
    "metrics": "Grafana Cloud"
  },
  "ci_cd": {
    "platform": "GitHub Actions",
    "containerization": "Docker (optional)"
  },
  "blockchain_infrastructure": {
    "rpc": "Sui Foundation Public RPC",
    "indexer": "Surflux DeepBook Indexer",
    "oracle": "Pyth Network"
  }
}
```

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„

### æ¨¡çµ„ä¸€ï¼šä¿è­‰é‡‘äº¤æ˜“ç³»çµ±

#### åŠŸèƒ½æè¿°

æä¾›å®Œæ•´çš„ DeepBook Margin äº¤æ˜“ç•Œé¢ï¼Œæ”¯æŒå¸‚åƒ¹å–®ã€é™åƒ¹å–®ã€æ§“æ¡¿é¸æ“‡å’Œå¯¦æ™‚é¢¨éšªç›£æ§ã€‚

#### çµ„ä»¶æ¶æ§‹

```
TradingModule/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TradingPanel.tsx          # ä¸»äº¤æ˜“é¢æ¿
â”‚   â”œâ”€â”€ OrderForm.tsx              # è¨‚å–®è¡¨å–®
â”‚   â”œâ”€â”€ PositionList.tsx           # æŒå€‰åˆ—è¡¨
â”‚   â”œâ”€â”€ OrderHistory.tsx           # æ­·å²è¨‚å–®
â”‚   â”œâ”€â”€ MarketDepth.tsx            # å¸‚å ´æ·±åº¦åœ–
â”‚   â””â”€â”€ PriceChart.tsx             # åƒ¹æ ¼èµ°å‹¢åœ–
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useTradingPanel.ts         # äº¤æ˜“é¢æ¿é‚è¼¯
â”‚   â”œâ”€â”€ useMarginManager.ts        # Margin Manager ç®¡ç†
â”‚   â”œâ”€â”€ useOrderBook.ts            # è¨‚å–®ç°¿æ•¸æ“š
â”‚   â””â”€â”€ usePositions.ts            # æŒå€‰ç®¡ç†
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ deepbook.ts                # DeepBook API å°è£
â”‚   â”œâ”€â”€ marginManager.ts           # Margin Manager æ“ä½œ
â”‚   â””â”€â”€ orderExecution.ts          # è¨‚å–®åŸ·è¡Œé‚è¼¯
â””â”€â”€ types/
    â”œâ”€â”€ trading.ts                 # äº¤æ˜“ç›¸é—œé¡å‹
    â””â”€â”€ orders.ts                  # è¨‚å–®é¡å‹å®šç¾©
```

#### æ ¸å¿ƒé‚è¼¯

**1. Margin Manager å‰µå»ºèˆ‡ç®¡ç†**

```typescript
// services/marginManager.ts

import { TransactionBlock } from '@mysten/sui.js/transactions';
import { SuiClient } from '@mysten/sui.js/client';

export interface MarginManagerConfig {
  poolId: string;
  initialCollateral: bigint;
  collateralType: 'SUI' | 'USDC';
}

export class MarginManagerService {
  constructor(
    private suiClient: SuiClient,
    private packageId: string
  ) {}

  /**
   * å‰µå»ºæ–°çš„ Margin Manager
   */
  async createMarginManager(
    config: MarginManagerConfig,
    userAddress: string
  ): Promise<string> {
    const tx = new TransactionBlock();

    // æº–å‚™æŠµæŠ¼å“
    const [collateralCoin] = tx.splitCoins(tx.gas, [
      tx.pure(config.initialCollateral)
    ]);

    // èª¿ç”¨ DeepBook Margin å‰µå»º Manager
    tx.moveCall({
      target: `${this.packageId}::margin_manager::create`,
      arguments: [
        tx.object(config.poolId),
        collateralCoin,
      ],
      typeArguments: [
        config.collateralType === 'SUI' ? '0x2::sui::SUI' : '0x...::usdc::USDC'
      ]
    });

    const result = await this.suiClient.signAndExecuteTransactionBlock({
      transactionBlock: tx,
      sender: userAddress,
      options: {
        showEffects: true,
        showObjectChanges: true,
      }
    });

    // æå–å‰µå»ºçš„ Margin Manager ID
    const managerObject = result.objectChanges?.find(
      obj => obj.type === 'created' && obj.objectType.includes('MarginManager')
    );

    if (!managerObject || managerObject.type !== 'created') {
      throw new Error('Failed to create Margin Manager');
    }

    return managerObject.objectId;
  }

  /**
   * æŸ¥è©¢ Margin Manager ç‹€æ…‹
   */
  async getMarginManagerState(managerId: string) {
    const object = await this.suiClient.getObject({
      id: managerId,
      options: { showContent: true, showType: true }
    });

    if (!object.data?.content || object.data.content.dataType !== 'moveObject') {
      throw new Error('Invalid Margin Manager object');
    }

    const fields = object.data.content.fields as any;

    return {
      poolId: fields.pool_id,
      baseBalance: BigInt(fields.base_balance),
      quoteBalance: BigInt(fields.quote_balance),
      borrowedBase: BigInt(fields.borrowed_base),
      borrowedQuote: BigInt(fields.borrowed_quote),
      entryPrice: BigInt(fields.entry_price),
      riskRatio: this.calculateRiskRatio(fields),
    };
  }

  /**
   * è¨ˆç®—é¢¨éšªæ¯”ç‡
   */
  private calculateRiskRatio(fields: any): number {
    const baseBalance = BigInt(fields.base_balance);
    const quoteBalance = BigInt(fields.quote_balance);
    const borrowedBase = BigInt(fields.borrowed_base);
    const borrowedQuote = BigInt(fields.borrowed_quote);

    // éœ€è¦ç•¶å‰åƒ¹æ ¼ï¼Œé€™è£¡ç°¡åŒ–è™•ç†
    // å¯¦éš›æ‡‰å¾ price oracle ç²å–
    const currentPrice = BigInt(fields.entry_price);

    const totalAssets = baseBalance * currentPrice + quoteBalance;
    const totalDebt = borrowedBase * currentPrice + borrowedQuote;

    if (totalDebt === 0n) return Infinity;

    return Number(totalAssets * 10000n / totalDebt) / 10000;
  }

  /**
   * å¢åŠ ä¿è­‰é‡‘
   */
  async addCollateral(
    managerId: string,
    amount: bigint,
    userAddress: string
  ): Promise<void> {
    const tx = new TransactionBlock();

    const [coin] = tx.splitCoins(tx.gas, [tx.pure(amount)]);

    tx.moveCall({
      target: `${this.packageId}::margin_manager::add_collateral`,
      arguments: [
        tx.object(managerId),
        coin,
      ]
    });

    await this.suiClient.signAndExecuteTransactionBlock({
      transactionBlock: tx,
      sender: userAddress,
    });
  }
}
```

**2. è¨‚å–®åŸ·è¡Œé‚è¼¯**

```typescript
// services/orderExecution.ts

export interface OrderParams {
  marginManagerId: string;
  poolId: string;
  side: 'BUY' | 'SELL';
  orderType: 'MARKET' | 'LIMIT';
  quantity: bigint;
  price?: bigint; // é™åƒ¹å–®å¿…å¡«
  leverage: number; // 1-10
  stopLoss?: bigint;
  takeProfit?: bigint;
}

export interface OrderValidation {
  isValid: boolean;
  errors: string[];
  warnings: string[];
  estimatedMarginRequired: bigint;
  estimatedLiquidationPrice: bigint;
  estimatedRiskRatio: number;
}

export class OrderExecutionService {
  constructor(
    private suiClient: SuiClient,
    private packageId: string,
    private riskEngine: RiskEngine
  ) {}

  /**
   * é©—è­‰è¨‚å–®
   */
  async validateOrder(params: OrderParams): Promise<OrderValidation> {
    const errors: string[] = [];
    const warnings: string[] = [];

    // 1. åŸºæœ¬é©—è­‰
    if (params.quantity <= 0n) {
      errors.push('æ•¸é‡å¿…é ˆå¤§æ–¼ 0');
    }

    if (params.orderType === 'LIMIT' && !params.price) {
      errors.push('é™åƒ¹å–®å¿…é ˆæä¾›åƒ¹æ ¼');
    }

    if (params.leverage < 1 || params.leverage > 10) {
      errors.push('æ§“æ¡¿å¿…é ˆåœ¨ 1-10 ä¹‹é–“');
    }

    // 2. ç²å–ç•¶å‰ Margin Manager ç‹€æ…‹
    const managerState = await this.getManagerState(params.marginManagerId);

    // 3. è¨ˆç®—é ä¼°æŒ‡æ¨™
    const currentPrice = await this.getCurrentPrice(params.poolId);
    const orderValue = params.quantity * (params.price || currentPrice);
    const marginRequired = orderValue / BigInt(params.leverage);

    // 4. æª¢æŸ¥å¯ç”¨ä¿è­‰é‡‘
    const availableMargin = this.calculateAvailableMargin(managerState);
    if (marginRequired > availableMargin) {
      errors.push(
        `ä¿è­‰é‡‘ä¸è¶³ã€‚éœ€è¦: ${formatCurrency(marginRequired)}, å¯ç”¨: ${formatCurrency(availableMargin)}`
      );
    }

    // 5. è¨ˆç®—ä¸‹å–®å¾Œçš„é¢¨éšªæŒ‡æ¨™
    const simulatedState = this.simulateOrder(managerState, params, currentPrice);
    const newRiskRatio = this.riskEngine.calculateRiskRatio(simulatedState);
    const liquidationPrice = this.riskEngine.calculateLiquidationPrice(simulatedState);

    // 6. é¢¨éšªæª¢æŸ¥
    if (newRiskRatio < 1.2) {
      errors.push(`é¢¨éšªæ¯”ç‡éä½ (${newRiskRatio.toFixed(2)}), æœ€ä½è¦æ±‚ 1.2`);
    } else if (newRiskRatio < 1.5) {
      warnings.push(`é¢¨éšªæ¯”ç‡è¼ƒä½ (${newRiskRatio.toFixed(2)}), å»ºè­°ä¿æŒåœ¨ 1.5 ä»¥ä¸Š`);
    }

    // 7. æ»‘é»è­¦å‘Š
    if (params.orderType === 'MARKET') {
      const estimatedSlippage = await this.estimateSlippage(
        params.poolId,
        params.side,
        params.quantity
      );

      if (estimatedSlippage > 0.01) { // 1%
        warnings.push(`é ä¼°æ»‘é»è¼ƒé«˜: ${(estimatedSlippage * 100).toFixed(2)}%`);
      }
    }

    return {
      isValid: errors.length === 0,
      errors,
      warnings,
      estimatedMarginRequired: marginRequired,
      estimatedLiquidationPrice: liquidationPrice,
      estimatedRiskRatio: newRiskRatio,
    };
  }

  /**
   * åŸ·è¡Œå¸‚åƒ¹å–®
   */
  async executeMarketOrder(
    params: OrderParams,
    userAddress: string
  ): Promise<ExecutionResult> {
    // å…ˆé©—è­‰
    const validation = await this.validateOrder(params);
    if (!validation.isValid) {
      throw new Error(`è¨‚å–®é©—è­‰å¤±æ•—: ${validation.errors.join(', ')}`);
    }

    const tx = new TransactionBlock();

    // èª¿ç”¨ DeepBook Margin å¸‚åƒ¹å–®å‡½æ•¸
    const result = tx.moveCall({
      target: `${this.packageId}::pool_proxy::place_market_order`,
      arguments: [
        tx.object(params.marginManagerId),
        tx.object(params.poolId),
        tx.pure(params.quantity),
        tx.pure(params.side === 'BUY'),
      ]
    });

    // å¦‚æœè¨­ç½®äº†æ­¢æ/æ­¢ç›ˆï¼Œå‰µå»ºè§¸ç™¼å™¨
    if (params.stopLoss || params.takeProfit) {
      await this.createAutoTriggers(tx, params, result);
    }

    const txResult = await this.suiClient.signAndExecuteTransactionBlock({
      transactionBlock: tx,
      sender: userAddress,
      options: {
        showEffects: true,
        showEvents: true,
      }
    });

    return this.parseExecutionResult(txResult);
  }

  /**
   * åŸ·è¡Œé™åƒ¹å–®
   */
  async executeLimitOrder(
    params: OrderParams,
    userAddress: string
  ): Promise<ExecutionResult> {
    if (!params.price) {
      throw new Error('é™åƒ¹å–®å¿…é ˆæä¾›åƒ¹æ ¼');
    }

    const validation = await this.validateOrder(params);
    if (!validation.isValid) {
      throw new Error(`è¨‚å–®é©—è­‰å¤±æ•—: ${validation.errors.join(', ')}`);
    }

    const tx = new TransactionBlock();

    tx.moveCall({
      target: `${this.packageId}::pool_proxy::place_limit_order`,
      arguments: [
        tx.object(params.marginManagerId),
        tx.object(params.poolId),
        tx.pure(params.price),
        tx.pure(params.quantity),
        tx.pure(params.side === 'BUY'),
      ]
    });

    const txResult = await this.suiClient.signAndExecuteTransactionBlock({
      transactionBlock: tx,
      sender: userAddress,
      options: {
        showEffects: true,
        showEvents: true,
      }
    });

    return this.parseExecutionResult(txResult);
  }

  // ... è¼”åŠ©æ–¹æ³•å¯¦ç¾
}
```

**3. å‰ç«¯äº¤æ˜“é¢æ¿çµ„ä»¶**

```typescript
// components/TradingPanel.tsx

import React, { useState, useEffect } from 'react';
import { useWallet } from '@/hooks/useWallet';
import { useTradingPanel } from '@/hooks/useTradingPanel';
import { OrderForm } from './OrderForm';
import { RiskMetrics } from './RiskMetrics';
import { PositionList } from './PositionList';

export const TradingPanel: React.FC = () => {
  const { address, signAndExecuteTransactionBlock } = useWallet();
  const {
    marginManager,
    currentPrice,
    orderParams,
    validation,
    isExecuting,
    setOrderParams,
    executeOrder,
  } = useTradingPanel();

  const [orderType, setOrderType] = useState<'MARKET' | 'LIMIT'>('MARKET');
  const [side, setSide] = useState<'BUY' | 'SELL'>('BUY');

  const handleSubmit = async () => {
    if (!validation.isValid) return;

    try {
      const result = await executeOrder({
        ...orderParams,
        orderType,
        side,
      });

      toast.success(`è¨‚å–®åŸ·è¡ŒæˆåŠŸ! Tx: ${result.digest}`);
    } catch (error) {
      toast.error(`è¨‚å–®åŸ·è¡Œå¤±æ•—: ${error.message}`);
    }
  };

  return (
    <div className="trading-panel">
      <div className="trading-panel__header">
        <h2>ä¿è­‰é‡‘äº¤æ˜“</h2>
        <div className="price-display">
          <span className="label">ç•¶å‰åƒ¹æ ¼:</span>
          <span className="value">${formatPrice(currentPrice)}</span>
        </div>
      </div>

      <div className="trading-panel__body">
        {/* å·¦å´ï¼šè¨‚å–®è¡¨å–® */}
        <div className="order-section">
          <OrderForm
            orderType={orderType}
            side={side}
            params={orderParams}
            validation={validation}
            onOrderTypeChange={setOrderType}
            onSideChange={setSide}
            onParamsChange={setOrderParams}
          />

          <button
            onClick={handleSubmit}
            disabled={!validation.isValid || isExecuting}
            className={`submit-button ${side.toLowerCase()}`}
          >
            {isExecuting ? 'åŸ·è¡Œä¸­...' : `${side === 'BUY' ? 'åšå¤š' : 'åšç©º'}`}
          </button>

          {/* é©—è­‰éŒ¯èª¤/è­¦å‘Š */}
          {validation.errors.length > 0 && (
            <div className="validation-errors">
              {validation.errors.map((error, i) => (
                <div key={i} className="error">{error}</div>
              ))}
            </div>
          )}

          {validation.warnings.length > 0 && (
            <div className="validation-warnings">
              {validation.warnings.map((warning, i) => (
                <div key={i} className="warning">{warning}</div>
              ))}
            </div>
          )}
        </div>

        {/* å³å´ï¼šé¢¨éšªæŒ‡æ¨™ */}
        <div className="risk-section">
          <RiskMetrics
            marginManager={marginManager}
            estimatedMetrics={{
              marginRequired: validation.estimatedMarginRequired,
              liquidationPrice: validation.estimatedLiquidationPrice,
              riskRatio: validation.estimatedRiskRatio,
            }}
          />
        </div>
      </div>

      {/* åº•éƒ¨ï¼šæŒå€‰åˆ—è¡¨ */}
      <div className="trading-panel__footer">
        <PositionList marginManagerId={marginManager?.id} />
      </div>
    </div>
  );
};
```

---

### æ¨¡çµ„äºŒï¼šè¤‡è£½äº¤æ˜“ç³»çµ±

#### æ¶æ§‹é¸æ“‡ï¼ˆå„ªåŒ–ç‰ˆï¼‰

**æ–¹æ¡ˆï¼šæ··åˆå¼æ¶æ§‹ï¼ˆäº‹ä»¶é©…å‹• + å¾Œç«¯åŸ·è¡Œï¼‰**

```
Leader ä¸‹å–®
    â†“
æ™ºèƒ½åˆç´„ç™¼å‡ºäº‹ä»¶ (LeaderTradeSignal)
    â†“
å¾Œç«¯äº‹ä»¶ç›£è½å™¨æ¥æ”¶
    â†“
æŸ¥è©¢è©² Leader çš„æ´»èº Followers
    â†“
åŠ å…¥åŸ·è¡ŒéšŠåˆ—ï¼ˆBullMQï¼‰
    â†“
Worker æ‰¹æ¬¡è™•ç†
    â†“
   â”œâ”€ ä¸¦è¡Œé¢¨éšªæª¢æŸ¥
    â†“
   â”œâ”€ è¨ˆç®—è·Ÿå–®è¦æ¨¡
    â†“
   â””â”€ åŸ·è¡Œéˆä¸Šäº¤æ˜“
    â†“
ç™¼é€åŸ·è¡Œçµæœé€šçŸ¥
```

**å„ªå‹¢ï¼š**
- âœ… é–‹ç™¼é€Ÿåº¦å¿«ï¼Œé©åˆ Hackathon
- âœ… Gas æˆæœ¬å¯æ§ï¼ˆæŒ‰éœ€åŸ·è¡Œï¼‰
- âœ… å¯è™•ç†å¤§é‡ Followers
- âœ… å¤±æ•—é‡è©¦æ©Ÿåˆ¶å®Œå–„

**æ¬Šè¡¡ï¼š**
- âš ï¸ ä¾è³´å¾Œç«¯æœå‹™ï¼ˆä½†å¯è¨­ç½®å¤šå€‹ Worker æé«˜å¯ç”¨æ€§ï¼‰
- âš ï¸ 1-3 ç§’åŸ·è¡Œå»¶é²ï¼ˆå¯æ¥å—ï¼Œå› ç‚ºä¿è­‰é‡‘äº¤æ˜“é€šå¸¸ä¸æ˜¯è¶…é«˜é »ï¼‰

#### æ™ºèƒ½åˆç´„è¨­è¨ˆ

```move
// sources/copy_trade.move

module margin_master::copy_trade {
    use sui::object::{Self, UID, ID};
    use sui::tx_context::{Self, TxContext};
    use sui::event;
    use sui::table::{Self, Table};
    use sui::coin::{Self, Coin};
    use sui::sui::SUI;
    use std::option::{Self, Option};

    // ==================== éŒ¯èª¤ç¢¼ ====================

    const E_UNAUTHORIZED: u64 = 1;
    const E_INVALID_COPY_RATIO: u64 = 2;
    const E_INVALID_FEE_RATE: u64 = 3;
    const E_RELATION_ALREADY_EXISTS: u64 = 4;
    const E_RELATION_NOT_FOUND: u64 = 5;
    const E_RISK_TOO_HIGH: u64 = 6;
    const E_INSUFFICIENT_BALANCE: u64 = 7;

    // ==================== å¸¸æ•¸ ====================

    const MIN_RISK_RATIO_BPS: u64 = 12000; // 1.2x (120%)
    const MAX_COPY_RATIO_BPS: u64 = 10000; // 100%
    const MAX_FEE_RATE_BPS: u64 = 1000;    // 10%
    const BPS_DENOMINATOR: u64 = 10000;

    // ==================== æ•¸æ“šçµæ§‹ ====================

    /// è·Ÿå–®é—œä¿‚
    struct CopyTradeRelation has key, store {
        id: UID,
        leader: address,
        follower: address,
        copy_ratio: u64,        // Basis points (0-10000)
        max_position_size: u64, // å–®ç­†æœ€å¤§å€‰ä½ï¼ˆquote currencyï¼‰
        fee_rate: u64,          // Basis points
        is_active: bool,
        created_at: u64,
        total_copied_trades: u64,
        total_fees_paid: u64,
    }

    /// äº¤æ˜“è€…æª”æ¡ˆ
    struct TraderProfile has key {
        id: UID,
        trader: address,
        total_followers: u64,
        total_pnl: i64,
        win_rate: u64,          // Basis points
        max_drawdown: u64,      // Basis points
        total_trades: u64,
        winning_trades: u64,
        active_positions: u64,
        total_fees_earned: u64,
        is_verified: bool,
        tier: u8,               // 0=None, 1=Bronze, 2=Silver, 3=Gold, 4=Platinum
        created_at: u64,
    }

    /// è¤‡è£½äº¤æ˜“é—œä¿‚è¨»å†Šè¡¨ï¼ˆå…¨å±€å–®ä¾‹ï¼‰
    struct CopyTradeRegistry has key {
        id: UID,
        // leader => follower[] æ˜ å°„
        leader_to_followers: Table<address, vector<address>>,
        // follower => leader[] æ˜ å°„
        follower_to_leaders: Table<address, vector<address>>,
        total_relations: u64,
    }

    /// è²»ç”¨æ”¶å–é…ç½®ï¼ˆå…¨å±€å–®ä¾‹ï¼‰
    struct FeeConfig has key {
        id: UID,
        protocol_fee_rate: u64,  // Protocol æŠ½æˆï¼ˆbasis pointsï¼‰
        treasury: address,       // Protocol treasury åœ°å€
    }

    // ==================== äº‹ä»¶ ====================

    /// Leader äº¤æ˜“ä¿¡è™Ÿäº‹ä»¶
    struct LeaderTradeSignal has copy, drop {
        leader: address,
        pool_id: ID,
        side: bool,              // true = BUY, false = SELL
        order_type: u8,          // 0 = MARKET, 1 = LIMIT
        price: Option<u64>,      // é™åƒ¹å–®åƒ¹æ ¼
        quantity: u64,
        leverage: u8,
        timestamp: u64,
    }

    /// è·Ÿå–®åŸ·è¡Œäº‹ä»¶
    struct CopyTradeExecuted has copy, drop {
        leader: address,
        follower: address,
        original_quantity: u64,
        copied_quantity: u64,
        copy_ratio: u64,
        fee_paid: u64,
        timestamp: u64,
    }

    /// è·Ÿå–®é—œä¿‚å‰µå»ºäº‹ä»¶
    struct CopyRelationCreated has copy, drop {
        leader: address,
        follower: address,
        copy_ratio: u64,
        max_position_size: u64,
        fee_rate: u64,
        timestamp: u64,
    }

    /// è·Ÿå–®é—œä¿‚åœæ­¢äº‹ä»¶
    struct CopyRelationStopped has copy, drop {
        leader: address,
        follower: address,
        timestamp: u64,
    }

    // ==================== åˆå§‹åŒ– ====================

    /// æ¨¡çµ„åˆå§‹åŒ–ï¼ˆåƒ…åœ¨ç™¼å¸ƒæ™‚èª¿ç”¨ä¸€æ¬¡ï¼‰
    fun init(ctx: &mut TxContext) {
        // å‰µå»ºå…¨å±€è¨»å†Šè¡¨
        let registry = CopyTradeRegistry {
            id: object::new(ctx),
            leader_to_followers: table::new(ctx),
            follower_to_leaders: table::new(ctx),
            total_relations: 0,
        };
        transfer::share_object(registry);

        // å‰µå»ºè²»ç”¨é…ç½®
        let fee_config = FeeConfig {
            id: object::new(ctx),
            protocol_fee_rate: 500, // 5%
            treasury: tx_context::sender(ctx), // è‡¨æ™‚è¨­ç½®ç‚ºéƒ¨ç½²è€…
        };
        transfer::share_object(fee_config);
    }

    // ==================== æ ¸å¿ƒåŠŸèƒ½ ====================

    /// å‰µå»ºäº¤æ˜“è€…æª”æ¡ˆ
    public entry fun create_trader_profile(ctx: &mut TxContext) {
        let sender = tx_context::sender(ctx);

        let profile = TraderProfile {
            id: object::new(ctx),
            trader: sender,
            total_followers: 0,
            total_pnl: 0,
            win_rate: 0,
            max_drawdown: 0,
            total_trades: 0,
            winning_trades: 0,
            active_positions: 0,
            total_fees_earned: 0,
            is_verified: false,
            tier: 0,
            created_at: tx_context::epoch(ctx),
        };

        transfer::transfer(profile, sender);
    }

    /// å‰µå»ºè·Ÿå–®é—œä¿‚
    public entry fun create_copy_relation(
        registry: &mut CopyTradeRegistry,
        leader: address,
        copy_ratio: u64,
        max_position_size: u64,
        fee_rate: u64,
        ctx: &mut TxContext
    ) {
        let follower = tx_context::sender(ctx);

        // é©—è­‰åƒæ•¸
        assert!(copy_ratio > 0 && copy_ratio <= MAX_COPY_RATIO_BPS, E_INVALID_COPY_RATIO);
        assert!(fee_rate <= MAX_FEE_RATE_BPS, E_INVALID_FEE_RATE);
        assert!(leader != follower, E_UNAUTHORIZED);

        // æª¢æŸ¥æ˜¯å¦å·²å­˜åœ¨é—œä¿‚
        // ï¼ˆç°¡åŒ–å¯¦ç¾ï¼Œå¯¦éš›éœ€éæ­·æª¢æŸ¥ï¼‰

        // å‰µå»ºé—œä¿‚å°è±¡
        let relation = CopyTradeRelation {
            id: object::new(ctx),
            leader,
            follower,
            copy_ratio,
            max_position_size,
            fee_rate,
            is_active: true,
            created_at: tx_context::epoch(ctx),
            total_copied_trades: 0,
            total_fees_paid: 0,
        };

        // æ›´æ–°è¨»å†Šè¡¨
        update_registry_on_create(registry, leader, follower);
        registry.total_relations = registry.total_relations + 1;

        // ç™¼å‡ºäº‹ä»¶
        event::emit(CopyRelationCreated {
            leader,
            follower,
            copy_ratio,
            max_position_size,
            fee_rate,
            timestamp: tx_context::epoch(ctx),
        });

        // è½‰ç§»é—œä¿‚å°è±¡çµ¦ follower
        transfer::transfer(relation, follower);
    }

    /// åœæ­¢è·Ÿå–®é—œä¿‚
    public entry fun stop_copy_relation(
        registry: &mut CopyTradeRegistry,
        relation: CopyTradeRelation,
        ctx: &mut TxContext
    ) {
        let sender = tx_context::sender(ctx);

        // é©—è­‰æ¬Šé™
        assert!(relation.follower == sender, E_UNAUTHORIZED);

        // æ›´æ–°è¨»å†Šè¡¨
        update_registry_on_stop(registry, relation.leader, relation.follower);
        registry.total_relations = registry.total_relations - 1;

        // ç™¼å‡ºäº‹ä»¶
        event::emit(CopyRelationStopped {
            leader: relation.leader,
            follower: relation.follower,
            timestamp: tx_context::epoch(ctx),
        });

        // éŠ·æ¯€é—œä¿‚å°è±¡
        let CopyTradeRelation {
            id,
            leader: _,
            follower: _,
            copy_ratio: _,
            max_position_size: _,
            fee_rate: _,
            is_active: _,
            created_at: _,
            total_copied_trades: _,
            total_fees_paid: _,
        } = relation;
        object::delete(id);
    }

    /// Leader ç™¼å‡ºäº¤æ˜“ä¿¡è™Ÿï¼ˆç”±å‰ç«¯èª¿ç”¨ï¼Œéš¨ DeepBook äº¤æ˜“ä¸€èµ·åŸ·è¡Œï¼‰
    public entry fun emit_leader_trade_signal(
        profile: &mut TraderProfile,
        pool_id: ID,
        side: bool,
        order_type: u8,
        price: Option<u64>,
        quantity: u64,
        leverage: u8,
        ctx: &mut TxContext
    ) {
        let sender = tx_context::sender(ctx);
        assert!(profile.trader == sender, E_UNAUTHORIZED);

        // æ›´æ–°çµ±è¨ˆ
        profile.total_trades = profile.total_trades + 1;
        profile.active_positions = profile.active_positions + 1;

        // ç™¼å‡ºäº‹ä»¶ï¼ˆå¾Œç«¯ç›£è½æ­¤äº‹ä»¶ï¼‰
        event::emit(LeaderTradeSignal {
            leader: sender,
            pool_id,
            side,
            order_type,
            price,
            quantity,
            leverage,
            timestamp: tx_context::epoch(ctx),
        });
    }

    /// åŸ·è¡Œè·Ÿå–®ï¼ˆç”±å¾Œç«¯æœå‹™èª¿ç”¨ï¼Œä»£è¡¨ followerï¼‰
    /// æ³¨æ„ï¼šå¯¦éš›åŸ·è¡Œ DeepBook äº¤æ˜“çš„é‚è¼¯åœ¨æ­¤å‡½æ•¸å¤–éƒ¨å®Œæˆ
    /// æ­¤å‡½æ•¸ä¸»è¦ç”¨æ–¼è¨˜éŒ„è·Ÿå–®ã€åˆ†é…è²»ç”¨
    public entry fun record_copy_trade_execution(
        relation: &mut CopyTradeRelation,
        leader_profile: &mut TraderProfile,
        fee_config: &FeeConfig,
        fee_payment: Coin<SUI>,
        original_quantity: u64,
        copied_quantity: u64,
        ctx: &mut TxContext
    ) {
        let sender = tx_context::sender(ctx);

        // é©—è­‰
        assert!(relation.follower == sender, E_UNAUTHORIZED);
        assert!(relation.is_active, E_RELATION_NOT_FOUND);

        // è¨ˆç®—è²»ç”¨
        let total_fee = coin::value(&fee_payment);
        let protocol_fee = (total_fee * fee_config.protocol_fee_rate) / BPS_DENOMINATOR;
        let leader_fee = total_fee - protocol_fee;

        // åˆ†é…è²»ç”¨
        let protocol_coin = coin::split(&mut fee_payment, protocol_fee, ctx);
        transfer::public_transfer(protocol_coin, fee_config.treasury);
        transfer::public_transfer(fee_payment, relation.leader);

        // æ›´æ–°çµ±è¨ˆ
        relation.total_copied_trades = relation.total_copied_trades + 1;
        relation.total_fees_paid = relation.total_fees_paid + total_fee;
        leader_profile.total_fees_earned = leader_profile.total_fees_earned + leader_fee;

        // ç™¼å‡ºäº‹ä»¶
        event::emit(CopyTradeExecuted {
            leader: relation.leader,
            follower: relation.follower,
            original_quantity,
            copied_quantity,
            copy_ratio: relation.copy_ratio,
            fee_paid: total_fee,
            timestamp: tx_context::epoch(ctx),
        });
    }

    // ==================== è¼”åŠ©å‡½æ•¸ ====================

    /// è¨ˆç®—è·Ÿå–®è¦æ¨¡
    public fun calculate_copy_size(
        leader_quantity: u64,
        copy_ratio: u64,
        max_position_size: u64
    ): u64 {
        let calculated_size = (leader_quantity * copy_ratio) / BPS_DENOMINATOR;

        if (calculated_size > max_position_size) {
            max_position_size
        } else {
            calculated_size
        }
    }

    /// æª¢æŸ¥é¢¨éšªæ˜¯å¦å¯æ¥å—
    public fun is_risk_acceptable(risk_ratio_bps: u64): bool {
        risk_ratio_bps >= MIN_RISK_RATIO_BPS
    }

    /// è¨ˆç®—è·Ÿå–®è²»ç”¨
    public fun calculate_copy_fee(
        position_value: u64,
        fee_rate: u64
    ): u64 {
        (position_value * fee_rate) / BPS_DENOMINATOR
    }

    // ==================== å…§éƒ¨å‡½æ•¸ ====================

    fun update_registry_on_create(
        registry: &mut CopyTradeRegistry,
        leader: address,
        follower: address
    ) {
        // ç°¡åŒ–å¯¦ç¾ï¼Œå¯¦éš›éœ€è™•ç† Table æ“ä½œ
        // å°‡ follower æ·»åŠ åˆ° leader_to_followers
        // å°‡ leader æ·»åŠ åˆ° follower_to_leaders
    }

    fun update_registry_on_stop(
        registry: &mut CopyTradeRegistry,
        leader: address,
        follower: address
    ) {
        // ç°¡åŒ–å¯¦ç¾ï¼Œå¯¦éš›éœ€è™•ç† Table æ“ä½œ
        // å¾ leader_to_followers ç§»é™¤ follower
        // å¾ follower_to_leaders ç§»é™¤ leader
    }

    // ==================== æŸ¥è©¢å‡½æ•¸ï¼ˆView Functionsï¼‰====================

    /// ç²å– Leader çš„ Followers æ•¸é‡
    public fun get_follower_count(profile: &TraderProfile): u64 {
        profile.total_followers
    }

    /// æª¢æŸ¥è·Ÿå–®é—œä¿‚æ˜¯å¦æ´»èº
    public fun is_relation_active(relation: &CopyTradeRelation): bool {
        relation.is_active
    }

    // ==================== ç®¡ç†å“¡åŠŸèƒ½ ====================

    /// æ›´æ–°å”è­°è²»ç‡ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
    public entry fun update_protocol_fee_rate(
        fee_config: &mut FeeConfig,
        new_rate: u64,
        ctx: &mut TxContext
    ) {
        // å¯¦éš›éœ€æ·»åŠ ç®¡ç†å“¡æ¬Šé™æª¢æŸ¥
        assert!(new_rate <= MAX_FEE_RATE_BPS, E_INVALID_FEE_RATE);
        fee_config.protocol_fee_rate = new_rate;
    }

    /// é©—è­‰äº¤æ˜“è€…ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
    public entry fun verify_trader(
        profile: &mut TraderProfile,
        tier: u8,
        ctx: &mut TxContext
    ) {
        // å¯¦éš›éœ€æ·»åŠ ç®¡ç†å“¡æ¬Šé™æª¢æŸ¥
        profile.is_verified = true;
        profile.tier = tier;
    }
}
```

#### å¾Œç«¯è·Ÿå–®åŸ·è¡Œå™¨

```typescript
// backend/src/services/copyTradeExecutor.ts

import { SuiClient } from '@mysten/sui.js/client';
import { TransactionBlock } from '@mysten/sui.js/transactions';
import { Queue, Worker } from 'bullmq';
import { prisma } from '@/lib/prisma';
import { redis } from '@/lib/redis';

interface CopyTradeJob {
  leaderAddress: string;
  tradeSignal: {
    poolId: string;
    side: 'BUY' | 'SELL';
    orderType: 'MARKET' | 'LIMIT';
    price?: string;
    quantity: string;
    leverage: number;
  };
  timestamp: number;
}

export class CopyTradeExecutor {
  private queue: Queue<CopyTradeJob>;
  private worker: Worker<CopyTradeJob>;

  constructor(
    private suiClient: SuiClient,
    private packageId: string
  ) {
    // å‰µå»ºä»»å‹™éšŠåˆ—
    this.queue = new Queue<CopyTradeJob>('copy-trade-execution', {
      connection: redis,
      defaultJobOptions: {
        attempts: 3,
        backoff: {
          type: 'exponential',
          delay: 2000,
        },
        removeOnComplete: 100,
        removeOnFail: 1000,
      }
    });

    // å‰µå»º Worker
    this.worker = new Worker<CopyTradeJob>(
      'copy-trade-execution',
      async (job) => this.processJob(job),
      {
        connection: redis,
        concurrency: 10, // ä¸¦è¡Œè™•ç† 10 å€‹ä»»å‹™
      }
    );

    this.setupEventHandlers();
  }

  /**
   * ç›£è½ Leader äº¤æ˜“ä¿¡è™Ÿäº‹ä»¶
   */
  async startEventListener() {
    const unsubscribe = await this.suiClient.subscribeEvent({
      filter: {
        MoveEventType: `${this.packageId}::copy_trade::LeaderTradeSignal`
      },
      onMessage: async (event) => {
        try {
          await this.handleLeaderTradeSignal(event);
        } catch (error) {
          console.error('è™•ç† Leader äº¤æ˜“ä¿¡è™Ÿå¤±æ•—:', error);
        }
      }
    });

    console.log('è·Ÿå–®äº‹ä»¶ç›£è½å™¨å·²å•Ÿå‹•');

    // è¿”å›å–æ¶ˆè¨‚é–±å‡½æ•¸
    return unsubscribe;
  }

  /**
   * è™•ç† Leader äº¤æ˜“ä¿¡è™Ÿ
   */
  private async handleLeaderTradeSignal(event: any) {
    const signal = event.parsedJson as {
      leader: string;
      pool_id: string;
      side: boolean;
      order_type: number;
      price?: string;
      quantity: string;
      leverage: number;
      timestamp: number;
    };

    console.log(`æ”¶åˆ° Leader ${signal.leader} çš„äº¤æ˜“ä¿¡è™Ÿ`);

    // æŸ¥è©¢è©² Leader çš„æ´»èº Followers
    const followers = await prisma.copyRelation.findMany({
      where: {
        leaderAddress: signal.leader,
        isActive: true,
      },
      include: {
        follower: true,
      }
    });

    console.log(`æ‰¾åˆ° ${followers.length} å€‹æ´»èº Followers`);

    // ç‚ºæ¯å€‹ Follower å‰µå»ºåŸ·è¡Œä»»å‹™
    const jobs = followers.map(relation => ({
      name: `copy-${signal.leader}-${relation.followerAddress}`,
      data: {
        leaderAddress: signal.leader,
        followerAddress: relation.followerAddress,
        relationId: relation.id,
        copyRatio: relation.copyRatio,
        maxPositionSize: relation.maxPositionSize,
        feeRate: relation.feeRate,
        tradeSignal: {
          poolId: signal.pool_id,
          side: signal.side ? 'BUY' : 'SELL',
          orderType: signal.order_type === 0 ? 'MARKET' : 'LIMIT',
          price: signal.price,
          quantity: signal.quantity,
          leverage: signal.leverage,
        },
        timestamp: signal.timestamp,
      },
    }));

    // æ‰¹é‡æ·»åŠ åˆ°éšŠåˆ—
    await this.queue.addBulk(jobs);
  }

  /**
   * è™•ç†å–®å€‹è·Ÿå–®ä»»å‹™
   */
  private async processJob(job: any): Promise<void> {
    const {
      leaderAddress,
      followerAddress,
      relationId,
      copyRatio,
      maxPositionSize,
      feeRate,
      tradeSignal,
    } = job.data;

    console.log(`é–‹å§‹è™•ç† Follower ${followerAddress} çš„è·Ÿå–®`);

    try {
      // 1. ç²å– Follower çš„ Margin Manager
      const followerManager = await this.getFollowerMarginManager(followerAddress);
      if (!followerManager) {
        throw new Error(`Follower ${followerAddress} æ²’æœ‰ Margin Manager`);
      }

      // 2. æª¢æŸ¥é¢¨éšªæ¯”ç‡
      const riskRatio = await this.checkRiskRatio(followerManager.id);
      if (riskRatio < 1.2) {
        console.log(`Follower ${followerAddress} é¢¨éšªæ¯”ç‡éä½ (${riskRatio}), è·³é`);
        await this.notifyFollower(followerAddress, {
          type: 'COPY_TRADE_SKIPPED',
          reason: 'RISK_TOO_HIGH',
          riskRatio,
        });
        return;
      }

      // 3. è¨ˆç®—è·Ÿå–®è¦æ¨¡
      const originalQuantity = BigInt(tradeSignal.quantity);
      const copiedQuantity = this.calculateCopySize(
        originalQuantity,
        copyRatio,
        BigInt(maxPositionSize)
      );

      if (copiedQuantity === 0n) {
        console.log(`è¨ˆç®—çš„è·Ÿå–®è¦æ¨¡ç‚º 0, è·³é`);
        return;
      }

      // 4. è¨ˆç®—è²»ç”¨
      const positionValue = copiedQuantity * BigInt(tradeSignal.price || 0);
      const totalFee = (positionValue * BigInt(feeRate)) / 10000n;

      // 5. åŸ·è¡Œéˆä¸Šäº¤æ˜“
      const txDigest = await this.executeCopyTrade({
        followerManager: followerManager.id,
        poolId: tradeSignal.poolId,
        side: tradeSignal.side,
        orderType: tradeSignal.orderType,
        price: tradeSignal.price,
        quantity: copiedQuantity.toString(),
        leverage: tradeSignal.leverage,
        fee: totalFee.toString(),
        relationId,
      });

      console.log(`è·Ÿå–®åŸ·è¡ŒæˆåŠŸ! Tx: ${txDigest}`);

      // 6. è¨˜éŒ„åˆ°æ•¸æ“šåº«
      await prisma.copyTradeExecution.create({
        data: {
          relationId,
          leaderAddress,
          followerAddress,
          originalQuantity: originalQuantity.toString(),
          copiedQuantity: copiedQuantity.toString(),
          copyRatio,
          feePaid: totalFee.toString(),
          txDigest,
          timestamp: new Date(),
        }
      });

      // 7. é€šçŸ¥ Follower
      await this.notifyFollower(followerAddress, {
        type: 'COPY_TRADE_EXECUTED',
        txDigest,
        quantity: copiedQuantity.toString(),
        fee: totalFee.toString(),
      });

    } catch (error) {
      console.error(`è™•ç†è·Ÿå–®ä»»å‹™å¤±æ•—:`, error);

      // é€šçŸ¥ Follower å¤±æ•—
      await this.notifyFollower(followerAddress, {
        type: 'COPY_TRADE_FAILED',
        reason: error.message,
      });

      throw error; // é‡æ–°æ‹‹å‡ºä»¥è§¸ç™¼é‡è©¦
    }
  }

  /**
   * åŸ·è¡Œéˆä¸Šè·Ÿå–®äº¤æ˜“
   */
  private async executeCopyTrade(params: {
    followerManager: string;
    poolId: string;
    side: 'BUY' | 'SELL';
    orderType: 'MARKET' | 'LIMIT';
    price?: string;
    quantity: string;
    leverage: number;
    fee: string;
    relationId: string;
  }): Promise<string> {
    // æ³¨æ„ï¼šå¯¦éš›å¯¦ç¾éœ€è¦ follower çš„ç§é‘°ä¾†ç°½ç½²äº¤æ˜“
    // åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ï¼Œæ‡‰ä½¿ç”¨æ›´å®‰å…¨çš„æ–¹æ¡ˆï¼Œä¾‹å¦‚ï¼š
    // 1. Follower é å…ˆæˆæ¬Šåˆç´„åŸ·è¡Œ
    // 2. ä½¿ç”¨ Threshold Signature / MPC
    // 3. Follower ä¸»å‹•æ‹‰å–ä¿¡è™Ÿä¸¦è‡ªè¡ŒåŸ·è¡Œ

    // é€™è£¡ç°¡åŒ–ç‚ºä½¿ç”¨ç³»çµ±ç§é‘°ï¼ˆåƒ… Demo ç”¨é€”ï¼‰
    const tx = new TransactionBlock();

    // æº–å‚™è²»ç”¨æ”¯ä»˜
    const [feeCoin] = tx.splitCoins(tx.gas, [tx.pure(params.fee)]);

    if (params.orderType === 'MARKET') {
      // åŸ·è¡Œå¸‚åƒ¹å–®
      tx.moveCall({
        target: `${this.packageId}::pool_proxy::place_market_order`,
        arguments: [
          tx.object(params.followerManager),
          tx.object(params.poolId),
          tx.pure(params.quantity),
          tx.pure(params.side === 'BUY'),
        ]
      });
    } else {
      // åŸ·è¡Œé™åƒ¹å–®
      if (!params.price) throw new Error('é™åƒ¹å–®éœ€è¦åƒ¹æ ¼');

      tx.moveCall({
        target: `${this.packageId}::pool_proxy::place_limit_order`,
        arguments: [
          tx.object(params.followerManager),
          tx.object(params.poolId),
          tx.pure(params.price),
          tx.pure(params.quantity),
          tx.pure(params.side === 'BUY'),
        ]
      });
    }

    // è¨˜éŒ„è·Ÿå–®åŸ·è¡Œï¼ˆæ”¯ä»˜è²»ç”¨ï¼‰
    tx.moveCall({
      target: `${this.packageId}::copy_trade::record_copy_trade_execution`,
      arguments: [
        tx.object(params.relationId), // CopyTradeRelation
        tx.object('LEADER_PROFILE_ID'), // TODO: éœ€è¦æŸ¥è©¢
        tx.object('FEE_CONFIG_ID'), // TODO: å¾é…ç½®ç²å–
        feeCoin,
        tx.pure(params.quantity),
        tx.pure(params.quantity),
      ]
    });

    const result = await this.suiClient.signAndExecuteTransactionBlock({
      transactionBlock: tx,
      // sender: followerAddress,
      // signer: followerKeypair,
      options: {
        showEffects: true,
      }
    });

    if (result.effects?.status?.status !== 'success') {
      throw new Error(`äº¤æ˜“å¤±æ•—: ${result.effects?.status?.error}`);
    }

    return result.digest;
  }

  // ... å…¶ä»–è¼”åŠ©æ–¹æ³•
}
```

---

ç”±æ–¼æ–‡æª”ç¯‡å¹…è¼ƒé•·ï¼Œæˆ‘å°‡åˆ†å¤šå€‹æª”æ¡ˆè¼¸å‡ºã€‚è®“æˆ‘ç¹¼çºŒå‰µå»ºå…¶ä»–é—œéµéƒ¨åˆ†çš„æ–‡æª”ã€‚
